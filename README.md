# Tako Jump

タコがジャンプで月を目指すモバイル向けウェブゲーム

## Play

https://hiroaki-sato1117.github.io/tako-jump/

## Architecture

```
tako-jump/
├── src/
│   ├── components/
│   │   └── Game.tsx          # メインゲームコンポーネント（状態管理・ゲームループ）
│   ├── game/
│   │   ├── config.ts         # 全設定値（調整はここ）
│   │   ├── types.ts          # 型定義
│   │   ├── physics.ts        # 物理演算（重力・衝突・ジャンプ）
│   │   ├── stage.ts          # ステージ生成（足場・月・星）
│   │   ├── renderer.ts       # Canvas描画
│   │   ├── storage.ts        # ハイスコア保存
│   │   └── index.ts          # エクスポート
│   ├── hooks/
│   │   ├── useGameLoop.ts    # 60fpsゲームループ
│   │   └── useKeyboardInput.ts # キーボード入力
│   └── assets/               # タコ画像（チャージ段階別）
├── docs/
│   ├── plan.md               # 開発計画
│   ├── stages.md             # ステージ設計
│   └── assets.md             # アセット仕様
└── CLAUDE.md                 # AI開発ガイドライン
```

## 用語

| 用語 | 説明 |
|------|------|
| **地面** | ステージの一番下にあるフラットな床（画面幅全体） |
| **足場** | 空中に浮いている着地できる場所（ノーマル、氷、キャタピラの3種類） |

## Config Reference

全ての調整可能なパラメータは `src/game/config.ts` に集約されています。

### Tako (タコ)
| パラメータ | 現在値 | 説明 |
|-----------|--------|------|
| `WIDTH` | 28 | タコの幅（px） |
| `HEIGHT` | 33 | タコの高さ（px） |
| `GRAVITY` | 0.4 | 重力加速度（毎フレーム） |
| `MAX_FALL_SPEED` | 10.5 | 最大落下速度 |
| `AIR_CONTROL` | 0.3 | 空中での微調整強度 |

### Jump (ジャンプ)
| パラメータ | 現在値 | 説明 |
|-----------|--------|------|
| `MAX_CHARGE_TIME` | 1000 | 最大チャージ時間（ms） |
| `MAX_VELOCITY` | 16.2 | 最大ジャンプ速度 |
| `MIN_VELOCITY` | 5.4 | 最小ジャンプ速度 |
| `MIN_ANGLE` | π×0.25 | 最小ジャンプ角度（45°） |
| `MAX_ANGLE` | π×0.75 | 最大ジャンプ角度（135°） |

**最大ジャンプ高さ**: 約328px（計算式: MAX_VELOCITY² / (2 × GRAVITY) = 16.2² / 0.8）

### Platform (足場)
| パラメータ | 現在値 | 説明 |
|-----------|--------|------|
| `BLOCK_SIZE` | 14 | 足場ブロックのサイズ（px） |
| `HEIGHT` | 14 | 足場の高さ（px） |

### Ice (氷の足場)
| パラメータ | 現在値 | 説明 |
|-----------|--------|------|
| `LANDING_SPEED_FACTOR` | 0.7 | 着地時の滑り速度係数 |
| `COLOR` | #87CEEB | 氷の足場の色 |

### Caterpillar (キャタピラ足場)
| パラメータ | 現在値 | 説明 |
|-----------|--------|------|
| `SPEED` | 1.5 | キャタピラの移動速度（px/frame） |
| `COLOR_LIGHT` | #A0A0A0 | 薄い灰色 |
| `COLOR_DARK` | #606060 | 濃い灰色 |

### Eel (スーパージャンプうなぎ)
| パラメータ | 現在値 | 説明 |
|-----------|--------|------|
| `SIZE` | 32 | うなぎのサイズ（px） |
| `SUPER_JUMP_VELOCITY` | 32.4 | スーパージャンプ速度（通常MAXの2倍） |
| `COLOR` | #FF6B6B | うなぎの色（薄い赤） |

### Stage Settings (ステージ設定)
各ステージには以下の設定があります：

| パラメータ | 説明 |
|-----------|------|
| `platformCount` | 足場の数 |
| `blockCountMin/Max` | 足場のブロック数範囲（幅に影響） |
| `gapMin/Max` | **足場と足場の間の距離**（px）※重要 |
| `normalRatio` | ノーマル足場の割合（0.0〜1.0） |
| `iceRatio` | 氷の足場の割合（0.0〜1.0） |
| `caterpillarRatio` | キャタピラ足場の割合（0.0〜1.0） |
| `eelCount` | スーパージャンプうなぎの数 |
| `waterSpeed` | 水の上昇速度 |
| `waterDelay` | 水が上昇し始めるまでの遅延（ms） |
| `baseTime` | 基準クリアタイム（スコア計算用） |

## 足場の種類

### 1. ノーマル足場
- サーモンピンク色
- 着地すると停止する

### 2. 氷の足場
- 水色（スカイブルー）
- 着地角度に応じて滑り続ける（速度一定、摩擦なし）
- 滑っている間もチャージ・ジャンプ可能

### 3. キャタピラ足場
- 灰色のベルトコンベア
- 乗るとキャタピラの方向にタコが運ばれる
- 足場の端まで運ばれると落下する

## ギミック

### スーパージャンプうなぎ
- 薄い赤色の円形キャラクター
- うなぎが曲がって円を描いた形
- 空中に浮遊し、ゆっくり回転している
- **触れるとスーパージャンプ発動**（通常MAXの2倍の高さ）
- 触れると消える（同じうなぎは1回しか使えない）
- ステージリスタート時にリセットされる

## Tuning Guide

### 難易度を上げたい
- `gapMin/Max` を増やす（足場間距離を広げる）
- `blockCountMin/Max` を減らす（足場を狭くする）
- `waterSpeed` を上げる（追われる圧力を増やす）
- `iceRatio` / `caterpillarRatio` を上げる

### 難易度を下げたい
- `gapMin/Max` を減らす（足場間距離を縮める）
- `blockCountMin/Max` を増やす（足場を広くする）
- `waterDelay` を増やす（準備時間を増やす）
- `eelCount` を増やす（スーパージャンプを増やす）

### ジャンプ感を調整
- `GRAVITY` を減らす → 滞空時間が長くなる
- `MAX_VELOCITY` を上げる → より高く跳べる
- `HORIZONTAL_FACTOR` を調整 → 横移動距離を変更

**注意**: `gapMax` は最大ジャンプ高さ（328px）を超えないようにする

## Key Mechanics

1. **シード固定ステージ**: 各ステージは番号でシード固定され、毎回同じ配置
2. **氷の足場**: 着地角度で滑り続ける（速度一定、摩擦なし）
3. **キャタピラ足場**: 乗ると端まで運ばれて落下
4. **スーパージャンプうなぎ**: 触れると2倍の高さにジャンプ
5. **ライフシステム**: 残機があれば同じステージからリスタート
6. **画面ループ**: 左右端でループ（右端→左端、左端→右端）

## Development

```bash
# 開発サーバー起動
npm run dev

# ビルド（型チェックなし、高速）
npm run build

# ビルド（型チェックあり）
npm run build:check

# 型チェックのみ
npm run typecheck

# デプロイ
npm run build && npx gh-pages -d dist
```

## Tech Stack

- React 18 + TypeScript
- Vite + SWC（高速ビルド）
- Canvas API（ゲーム描画）
- Tailwind CSS
